{% extends 'FOSUserBundle::layout.html.twig' %}

{% block body %}
    <div
            class="row"
    >
        <div
                class="col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3"
        >
            {{ form_start(searchForm, {
                'attr': {
                    'id': 'js-search-form'
                }
            }) }}
            {{ form_widget(searchForm) }}
            {{ form_end(searchForm) }}

            {% for text in texts %}

                <div
                        class="panel panel-default"
                >

                    <div
                            class="panel-heading"
                    >
                        <a
                                href="{{ path('app_text_show', {
                                    'username': text.createdBy.username,
                                    'slugBody': text.currentSlug,
                                }) }}"
                                class="panel-wrapper"
                        >
                            <h3
                                    class="panel-title"
                            >
                                {{ text.title }}
                            </h3>
                        </a>
                    </div>
                    <div
                            class="panel-body"
                    >
                        <a href="{{ path('app_user_show', {
                            'username': text.createdBy.username,
                        }) }}"
                           class="username-wrapper"
                        >
                            {% include ':components:gravatar.html.twig' with {
                            'email': text.createdBy.email,
                            'size': 20,
                            } %}
                            &nbsp;
                            {{ text.createdBy.name }}
                        </a>

                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script>
      $(document).ready(function() {
        var $body = $('body');
        var $form = $body.find('#js-search-form');
        var $textInput = $form.find('input');
        var request = null;

        $textInput.on(
          'input propertychange change selectionchange',
          function() {
            console.log($textInput.val());

            if (request !== null) {
              request.abort();
              request = null;
            }

            request = $.ajax({
              type: $form.attr('method'),
              url: $form.attr('action'),
              data: $textInput.val()
            }).done(function(response) {
              console.log(response);
            });







          }
        );





      });


    </script>
{% endblock %}
